#:kivy 2.3.0
#:import Factory kivy.factory.Factory


<widgettree>:
    id:main
    orientation :'vertical'
    spacing:10
    canvas.before:
        Rectangle:
            source:f'Images/{root.weather.day}_{root.weather.background_image}.jpg'
            size : self.size

    BoxLayout:
        orientation:'horizontal'
        spacing:10
        padding:10,-10
        size_hint_y:None
        
        Button:
            text: 'About'
            size_hint: None,None
            size:(100,100)
            pos:self.pos
            background_color: (1, 1, 1, 0.1)
            color:root.text_colour
            on_release: Factory.About().open()
            # border: (1,0,0,1)
            canvas.after:
                Color:
                    rgba: 1,1, 1, 1
                Line:
                    width: 1
                    rectangle: self.x, self.y, self.width, self.height
            canvas.before:
                Color:
                    rgba: 1,1,1,0.1
                Rectangle:
                    pos:self.pos
                    size:self.size

    BoxLayout:
        id:b1
        orientation:'horizontal'
        
        spacing:10
        padding:10,10
        RoundedBoxlayout:
            orientation:'vertical'
            size_hint : None,None
            size:(500,450)
            # pos: self.pos[0],self.parent.top - 250
            background_color: (1, 1, 1, 0.1)
            canvas.after:
                Color:
                    rgba: 1,1, 1, 1
                Line:
                    width: 1
                    rectangle: self.x, self.y, self.width, self.height
            canvas.before:
                Color:
                    rgba: 1,1, 1, 0.1
                Rectangle:
                    pos:self.pos
                    size:self.size
            Label:
                id:time
                text:'[b]'+root.weather.Time+'[/b]'
                markup:True
                font_size : 50
                font_name : 'Arial'
                color: root.text_colour
          
            Label:
                id:date_day
                text:root.weather.Date
                markup:True
                font_name : 'Arial'
                color: root.text_colour
                font_size : 30
                size:self.texture_size 
            
            Label:
                id:Location
                text:root.weather.City+'\n'+root.weather.Region
                markup:True
                font_name : 'Arial'
                color: root.text_colour
                font_size: 30
               
        BoxLayout:
            orientation :'vertical'
            size_hint : None,None
            size:(500,450)
            background_color: (1, 1, 1, 0.1)
            canvas.after:
                Color:
                    rgba: 1,1, 1, 1
                Line:
                    width: 1
                    rectangle: self.x, self.y, self.width, self.height
            canvas.before:
                Color:
                    rgba: 1,1, 1, 0.1
                Rectangle:
                    pos:self.pos
                    size:self.size
            # pos: self.pos[0],self.parent.top - 250
            FloatLayout:
                
                WeatherLabel:
                    id:Temperature
                    text:str(root.weather.Temperature_F)+chr(176)+'F'
                    markup: True
                    color : root.text_colour
                    font_size : 50
                    pos:self.parent.pos[0],self.parent.pos[1]+50
                Label:
                    id:Temperature_feelsLike
                    text:'feels like '+str(root.weather.Temperature_feelslike)+chr(176)+'F'
                    markup: True
                    color : root.text_colour
                    font_size : 20
                    pos:self.parent.pos[0],self.parent.pos[1]
                Label:
                    id:weather_
                    text:root.weather.weather
                    markup: True
                    color : root.text_colour
                    font_size : 25
                    pos:self.parent.pos[0],self.parent.pos[1]-25
                Label:
                    id:Humidity
                    text:'Humidity:'+str(root.weather.humidity)+'%'
                    markup: True
                    color : root.text_colour
                    font_size : 25
                    pos:self.parent.pos[0],self.parent.pos[1]-100

    
    TabbedPanel:
        padding:20,10
        do_default_tab: False
        background_color: (1, 0, 0, 0)
        border: (1,0,0,1)
        # background_image:'PS.jpg'
        
        TabbedPanelItem:
            text:"Hourly Forecast"
            color:root.text_colour
            background_color: (1, 0, 0, 0)
            border: (1,0,0,1)
            canvas.before:
                Color:
                    rgba: 1,1, 1, 1
                Line:
                    width: 1
                    rectangle: self.x, self.y, self.width, self.height
            ScrollView:

                do_scroll_x: True
                do_scroll_y: False
            
                BoxLayout:
                    orientation:'horizontal'
                    size_hint : None,None
                    size:(300,300)
                    spacing:280

                    Hour:
                
                        hour:(root.weather.current_hour+1)%24
                        day:root.weather.day
                        time:root.weather.hourdata(self.hour)[0]
                        temp:str(root.weather.hourdata(self.hour)[4])
                        weather:root.weather.hourdata(self.hour)[1]
                        weather_icon:str(root.weather.hourdata(self.hour)[2])
                        humidity:str(root.weather.hourdata(self.hour)[3])

                    Hour:
                        
                        hour:(root.weather.current_hour+2)%24
                        day:root.weather.day
                        time:root.weather.hourdata(self.hour)[0]
                        temp:str(root.weather.hourdata(self.hour)[4])
                        weather:root.weather.hourdata(self.hour)[1]
                        weather_icon:str(root.weather.hourdata(self.hour)[2])
                        humidity:str(root.weather.hourdata(self.hour)[3])
                    Hour:
                        
                        hour:(root.weather.current_hour+3)%24
                        day:root.weather.day
                        time:root.weather.hourdata(self.hour)[0]
                        temp:str(root.weather.hourdata(self.hour)[4])
                        weather:root.weather.hourdata(self.hour)[1]
                        weather_icon:str(root.weather.hourdata(self.hour)[2])
                        humidity:str(root.weather.hourdata(self.hour)[3])
                    Hour:
                        
                        hour:(root.weather.current_hour+4)%24
                        day:root.weather.day
                        time:root.weather.hourdata(self.hour)[0]
                        temp:str(root.weather.hourdata(self.hour)[4])
                        weather:root.weather.hourdata(self.hour)[1]
                        weather_icon:str(root.weather.hourdata(self.hour)[2])
                        humidity:str(root.weather.hourdata(self.hour)[3])
                    Hour:
                        
                        hour:(root.weather.current_hour+5)%24
                        day:root.weather.day
                        time:root.weather.hourdata(self.hour)[0]
                        temp:str(root.weather.hourdata(self.hour)[4])
                        weather:root.weather.hourdata(self.hour)[1]
                        weather_icon:str(root.weather.hourdata(self.hour)[2])
                        humidity:str(root.weather.hourdata(self.hour)[3])
                    Hour:
                        
                        hour:(root.weather.current_hour+6)%24
                        day:root.weather.day
                        time:root.weather.hourdata(self.hour)[0]
                        temp:str(root.weather.hourdata(self.hour)[4])
                        weather:root.weather.hourdata(self.hour)[1]
                        weather_icon:str(root.weather.hourdata(self.hour)[2])
                        humidity:str(root.weather.hourdata(self.hour)[3])
                   
        TabbedPanelItem:
            text:"Daily Forecast"
            color:root.text_colour
            background_color: (1, 0, 0, 0)
            border: (1,0,0,1)
            
            canvas.before:
                Color:
                    rgba: 1,1, 1, 1
                Line:
                    width: 1
                    rectangle: self.x, self.y, self.width, self.height
            ScrollView:

                do_scroll_x: True
                do_scroll_y: False
            
                BoxLayout:
                    orientation:'horizontal'
                    size_hint : None,None
                    size:(300,300)
                    spacing:280

                    Day:
                        n_day : 2
                        day:root.weather.day
                        date:root.weather.daydata(self.n_day)[8]
                        max:str(root.weather.daydata(self.n_day)[2])
                        min:str(root.weather.daydata(self.n_day)[3])
                        weather:root.weather.daydata(self.n_day)[4]
                        weather_icon:str(root.weather.daydata(self.n_day)[7])
                        humidity:str(root.weather.daydata(self.n_day)[6])
                        sunrise:root.weather.daydata(self.n_day)[0]
                        sunset:root.weather.daydata(self.n_day)[1]
                        
                    Day:
                        n_day : 3
                        day:root.weather.day
                        date:root.weather.daydata(self.n_day)[8]
                        max:str(root.weather.daydata(self.n_day)[2])
                        min:str(root.weather.daydata(self.n_day)[3])
                        weather:root.weather.daydata(self.n_day)[4]
                        weather_icon:str(root.weather.daydata(self.n_day)[7])
                        humidity:str(root.weather.daydata(self.n_day)[6])
                        sunrise:root.weather.daydata(self.n_day)[0]
                        sunset:root.weather.daydata(self.n_day)[1]

                    # Day:
                    #     n_day : 4
                    #     day:root.weather.day
                    #     date:root.weather.daydata(self.n_day)[8]
                    #     max:str(root.weather.daydata(self.n_day)[2])
                    #     min:str(root.weather.daydata(self.n_day)[3])
                    #     weather:root.weather.daydata(self.n_day)[4]
                    #     weather_icon:str(root.weather.daydata(self.n_day)[7])
                    #     humidity:str(root.weather.daydata(self.n_day)[6])
                    #     sunrise:root.weather.daydata(self.n_day)[0]
                    #     sunset:root.weather.daydata(self.n_day)[1]
                    
                    # Day:
                    #     n_day : 5
                    #     day:root.weather.day
                    #     date:root.weather.daydata(self.n_day)[8]
                    #     max:str(root.weather.daydata(self.n_day)[2])
                    #     min:str(root.weather.daydata(self.n_day)[3])
                    #     weather:root.weather.daydata(self.n_day)[4]
                    #     weather_icon:str(root.weather.daydata(self.n_day)[7])
                    #     humidity:str(root.weather.daydata(self.n_day)[6])
                    #     sunrise:root.weather.daydata(self.n_day)[0]
                    #     sunset:root.weather.daydata(self.n_day)[1]

                    # Day:
                    #     n_day : 6
                    #     day:root.weather.day
                    #     date:root.weather.daydata(self.n_day)[8]
                    #     max:str(root.weather.daydata(self.n_day)[2])
                    #     min:str(root.weather.daydata(self.n_day)[3])
                    #     weather:root.weather.daydata(self.n_day)[4]
                    #     weather_icon:str(root.weather.daydata(self.n_day)[7])
                    #     humidity:str(root.weather.daydata(self.n_day)[6])
                    #     sunrise:root.weather.daydata(self.n_day)[0]
                    #     sunset:root.weather.daydata(self.n_day)[1]

                    # Day:
                    #     n_day : 7
                    #     day:root.weather.day
                    #     date:root.weather.daydata(self.n_day)[8]
                    #     max:str(root.weather.daydata(self.n_day)[2])
                    #     min:str(root.weather.daydata(self.n_day)[3])
                    #     weather:root.weather.daydata(self.n_day)[4]
                    #     weather_icon:str(root.weather.daydata(self.n_day)[7])
                    #     humidity:str(root.weather.daydata(self.n_day)[6])
                    #     sunrise:root.weather.daydata(self.n_day)[0]
                    #     sunset:root.weather.daydata(self.n_day)[1]
                        
                    # Day:
                    #     n_day : 8
                    #     day:root.weather.day
                    #     date:root.weather.daydata(self.n_day)[8]
                    #     max:str(root.weather.daydata(self.n_day)[2])
                    #     min:str(root.weather.daydata(self.n_day)[3])
                    #     weather:root.weather.daydata(self.n_day)[4]
                    #     weather_icon:str(root.weather.daydata(self.n_day)[7])
                    #     humidity:str(root.weather.daydata(self.n_day)[6])
                    #     sunrise:root.weather.daydata(self.n_day)[0]
                    #     sunset:root.weather.daydata(self.n_day)[1]
                        
<RoundedBoxlayout@BoxLayout>:
    canvas.after:
        Color:
            rgba:(1,0,1,0)
        RoundedRectangle:
            size: self.size
            pos:self.pos
            radius:[18]

<RoundedLabel@Label>:
    canvas.before:
        Color:
            rgba: 1,1,1,1
        Line:
            width: 1
            rectangle: self.x, self.y, self.width, self.height
<BorderBoxLayout@BoxLayout>:
    canvas.before:
        Color:
            rgba: 1,1,1,1
        Line:
            width: 1
            rectangle: self.x, self.y, self.width, self.height
<WeatherLabel@Label>:
    day:'day'
    icon:'116'
    canvas.after:
        Color:
            rgba:(1,1,1,1)
        Rectangle:
            source:f'weather/weather/64x64/{root.day}/{root.icon}.png'
            size: (100,100)
            pos:self.center[0]+100,self.pos[1]
<TabbedPanelStrip>:
    padding:0,0
    canvas:
        Color:
            rgba: (1, 0, 0, 0) # green
        Rectangle:
            size: self.size
            pos: self.pos
<TabbedPanelHeader>:
    canvas:
        Color:
            rgba: (1, 0, 0, 0) # green
        Rectangle:
            size: self.size
            pos: self.pos

<Day@BoxLayout>:
    day:'day'
    date:'some_text'
    max:'some_text'
    min:'some_text'
    weather:'some_text'
    weather_icon:'116'
    humidity:'some_text'
    sunrise:'some_text'
    sunset:'some_text'
    n_day:1
    text_colour : [0,0,0,1] if root.day == 'day' else [1,1,1,1]
    BoxLayout:
        orientation:'horizontal'
        size_hint:None,None
        BorderBoxLayout:
            orientation:'vertical'
            size_hint:None,None
            size:(270,270)
            canvas.before:
                Color :
                    rgba : 1,1,1,0.1
                Rectangle:
                    # source:'Images/Sunny.jpg'
                    size : self.size
                    pos : self.pos
            Label:
                id:date
                text:root.date
                color:root.text_colour
            BoxLayout:
                orientation:'horizontal'
                BoxLayout:
                    orientation:'vertical'
                    Label:
                        id:one
                        text:f'Maximum'
                        color : root.text_colour
                        padding : 10,10
                        # pos:self.parent.center
                    Label:
                        id:one
                        text:f'{root.max}'+chr(176)+'F'
                        color : root.text_colour
                        padding : 10,10
                        # pos:self.parent.center
                    
                    
                BoxLayout:
                    orientation:'vertical'
                    Label:
                        id:one
                        text:f'Minimum'
                        color : root.text_colour
                        padding : 10,10
                        # pos:self.parent.center
                    Label:
                        id:one
                        text:f'{root.min}'+chr(176)+'F'
                        color : root.text_colour
                        padding : 10,10
                        # pos:self.parent.center
                
            BoxLayout:
                orientation:'horizontal'
                Label:
                    id:one
                    text:f'{root.weather}'
                    color : root.text_colour
                    padding : 10,10
                    
                Label:
                    id:one
                    size_hint:None,None
                    canvas.after:
                        Color:
                            rgba:(1,1,1,1)
                        Rectangle:
                            
                            source:f'weather/weather/64x64/day/{root.weather_icon}.png'
                            size: (75,75)
                            pos:self.pos[0],self.parent.pos[1]-10
                        
            
            Label:
                id:one
                text:f'Avg. Humidity :{root.humidity}%'
                color : root.text_colour
                padding : 10,10
            BoxLayout:
                orientation:'horizontal'
                BoxLayout:
                    orientation:'vertical'
                    Label:
                        id:one
                        text:f'Sunrise'
                        color : root.text_colour
                        padding : 10,10
                    Label:
                        id:one
                        text:f'{root.sunrise}'
                        color : root.text_colour
                        padding : 10,10
                    
                BoxLayout:
                    orientation:'vertical'
                    Label:
                        id:one
                        text:f'Sunset'
                        color : root.text_colour
                        padding : 10,10
                    Label:
                        id:one
                        text:f'{root.sunset}'
                        color : root.text_colour
                        padding : 10,10

<Hour@BoxLayout>:
    hour:1
    day:'day'
    text_colour : [0,0,0,1] if root.day == 'day' else [1,1,1,1]
    time:'time'
    temp:'Temp'
    weather:'some Text'
    weather_icon:'116'
    humidity:'some text'
    BoxLayout:
        orientation:'horizontal'
        size_hint:None,None
        BorderBoxLayout:
            orientation:'vertical'
            size_hint:None,None
            size:(270,270)
            canvas.before:
                Color :
                    rgba : 1,1,1,0.1
                Rectangle:
                    # source:'Images/Sunny.jpg'
                    size : self.size
                    pos : self.pos
            Label:
                id:Time
                text:root.time
                color:root.text_colour
            BoxLayout:
                orientation:'horizontal'
                BoxLayout:
                    orientation:'vertical'

                    Label:
                        id:one
                        text:f'{root.temp}'+chr(176)+'F'
                        color : root.text_colour
                        padding : 10,10
                        # pos:self.parent.center
                    
                
            BoxLayout:
                orientation:'horizontal'
                Label:
                    id:one
                    text:f'{root.weather}'
                    color : root.text_colour
                    padding : 10,10
                    
                Label:
                    id:one
                    size_hint:None,None
                    canvas.after:
                        Color:
                            rgba:(1,1,1,1)
                        Rectangle:
                            
                            source:f'weather/weather/64x64/day/{root.weather_icon}.png'
                            size: (75,75)
                            pos:self.pos[0],self.parent.pos[1]-10
                        
            
            Label:
                id:one
                text:f'Avg. Humidity :{root.humidity}%'
                color : root.text_colour
                padding : 10,10
<About@Popup>:
    auto_dismiss: False
    size_hint:None,None
    size:(400,400)
    title:'About'
    background_color:(1,1,1,0.1)
    title_color:[1,1,1,1]
    # canvas.after:
    #     Color:
    #         rgba:(1,1,1,0.1)
    #     Rectangle:
    #         size:self.size
    #         pos:self.pos
    BoxLayout:
        orientation:'vertical'
        Label:
            id:about1
            text:'Weather Forecast project '
        Label:
            id:about2
            text:'By Kishore K'
        Label:
            id:about3
            text:'Tech highs'
            
        Button:
            text: 'Close'
            on_release: root.dismiss()
            size_hint_y:None
            color:[1,1,1,1]
            background_color:[1,1,1,1]